---
# -------------------------------------------------------
# STEP 1: SET VARIABLES
# -------------------------------------------------------
- name: "Ensure Error List Exists (Fallback)"
  set_fact:
    health_check_errors: "{{ health_check_errors | default([]) }}"

# -------------------------------------------------------
# STEP 2: EXECUTE CHECKS (Modularized)
# -------------------------------------------------------
- name: "Wrapper: Execute Health Checks"
  block:
    - include_tasks: checks/01_variables.yml
    - include_tasks: checks/02_services.yml
    - include_tasks: checks/03_config_files.yml
    - include_tasks: checks/04_node_health.yml
    - include_tasks: checks/05_properties.yml
    - include_tasks: checks/06_stonith.yml
    - include_tasks: checks/07_failed_actions.yml
    - include_tasks: checks/08_stonith_history.yml
    - include_tasks: checks/09_split_brain.yml
    - include_tasks: checks/10_cluster_status.yml

# -------------------------------------------------------
# STEP 3. GENERATE REPORT
# -------------------------------------------------------
- name: "Generate Consolidated Report"
  include_tasks: reporting.yml